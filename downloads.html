<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‹è½½ä¸­å¿ƒ - è¿è¥ç®¡æ§å°</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .sidebar {
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
        }

        .nav-item.active {
            background: rgba(82, 196, 26, 0.2);
            border-left-color: #52c41a;
        }

        .logo-icon {
            background: #52c41a;
        }

        .dl-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .dl-stat {
            background: #fff;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .dl-stat .val {
            font-size: 28px;
            font-weight: 700;
        }

        .dl-stat .lbl {
            font-size: 13px;
            color: #8c8c8c;
            margin-top: 4px;
        }

        .dl-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 20px;
        }

        .dl-tab {
            padding: 8px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            background: #f5f5f5;
            color: #595959;
            transition: all 0.2s;
            border: none;
        }

        .dl-tab.active {
            background: #1890ff;
            color: #fff;
        }

        .dl-tab:hover:not(.active) {
            background: #e6e6e6;
        }

        .dl-item {
            background: #fff;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.2s;
        }

        .dl-item:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .dl-icon {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            flex-shrink: 0;
        }

        .dl-icon.excel {
            background: #f6ffed;
        }

        .dl-icon.csv {
            background: #e6f7ff;
        }

        .dl-icon.pdf {
            background: #fff1f0;
        }

        .dl-info {
            flex: 1;
        }

        .dl-info .dl-name {
            font-weight: 600;
            font-size: 14px;
            color: #262626;
        }

        .dl-info .dl-meta {
            font-size: 12px;
            color: #8c8c8c;
            margin-top: 4px;
            display: flex;
            gap: 16px;
        }

        .dl-info .dl-meta span {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .dl-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dl-status {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 500;
            gap: 4px;
        }

        .dl-status.done {
            background: #f6ffed;
            color: #52c41a;
        }

        .dl-status.running {
            background: #e6f7ff;
            color: #1890ff;
        }

        .dl-status.failed {
            background: #fff1f0;
            color: #f5222d;
        }

        .dl-status.expired {
            background: #f5f5f5;
            color: #bfbfbf;
        }

        /* è¿›åº¦æ¡ */
        .dl-progress {
            width: 120px;
            height: 6px;
            background: #f0f0f0;
            border-radius: 3px;
            overflow: hidden;
        }

        .dl-progress-bar {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s;
        }

        .dl-progress-bar.done {
            background: #52c41a;
            width: 100%;
        }

        .dl-progress-bar.p60 {
            background: #1890ff;
            width: 60%;
            animation: pulse 1.5s infinite;
        }

        .dl-progress-bar.p30 {
            background: #1890ff;
            width: 30%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #bfbfbf;
        }

        .empty-state .icon {
            font-size: 48px;
            margin-bottom: 12px;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-logo">
                <div class="logo-icon">âš™ï¸</div>
                <h1>è¿è¥ç®¡æ§å°</h1>
            </div>
            <nav class="nav-menu">
                <a href="index.html" class="nav-item"><span class="nav-icon">ğŸ“Š</span><span
                        class="nav-text">è¿è¥æ¦‚è§ˆ</span></a>
                <a href="institutions.html" class="nav-item"><span class="nav-icon">ğŸ›ï¸</span><span
                        class="nav-text">æœºæ„ç®¡ç†</span></a>
                <a href="customer-pool.html" class="nav-item"><span class="nav-icon">ğŸŠ</span><span
                        class="nav-text">å®¢æˆ·æ± </span></a>
                <a href="products.html" class="nav-item"><span class="nav-icon">ğŸ“¦</span><span
                        class="nav-text">äº§å“é…ç½®</span></a>
                <a href="rules.html" class="nav-item"><span class="nav-icon">ğŸ¯</span><span
                        class="nav-text">è§„åˆ™å¼•æ“</span></a>
                <a href="distribution.html" class="nav-item"><span class="nav-icon">ğŸ”€</span><span
                        class="nav-text">åˆ†å‘ç®¡ç†</span></a>
                <a href="analytics.html" class="nav-item"><span class="nav-icon">ğŸ“ˆ</span><span
                        class="nav-text">æ•ˆæœåˆ†æ</span></a>
                <a href="billing.html" class="nav-item"><span class="nav-icon">ğŸ’°</span><span
                        class="nav-text">æ”¶è´¹ç»“ç®—</span></a>
                <a href="reconciliation.html" class="nav-item"><span class="nav-icon">ğŸ“‘</span><span
                        class="nav-text">å¯¹è´¦ç®¡ç†</span></a>
                <a href="risk-alert.html" class="nav-item"><span class="nav-icon">âš ï¸</span><span
                        class="nav-text">é£é™©é¢„è­¦</span></a>
                <a href="api-monitor.html" class="nav-item"><span class="nav-icon">ğŸ”Œ</span><span
                        class="nav-text">APIç›‘æ§</span></a>
                <a href="downloads.html" class="nav-item active"><span class="nav-icon">ğŸ“¥</span><span
                        class="nav-text">ä¸‹è½½ä¸­å¿ƒ</span></a>
            </nav>
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar" style="background: #52c41a;">ç®¡</div>
                    <div>
                        <div class="user-name">ç®¡ç†å‘˜</div>
                        <div class="user-role">å¹³å°è¿è¥</div>
                    </div>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <div class="page-header" style="display:flex;justify-content:space-between;align-items:center;">
                <div>
                    <h2>ä¸‹è½½ä¸­å¿ƒ</h2>
                    <div class="breadcrumb">è¿è¥ç®¡æ§å° / ä¸‹è½½ä¸­å¿ƒ</div>
                </div>
                <div style="display:flex;gap:10px;">
                    <button class="btn btn-default" onclick="clearExpired()">ğŸ—‘ æ¸…ç†è¿‡æœŸæ–‡ä»¶</button>
                </div>
            </div>

            <!-- ç»Ÿè®¡ -->
            <div class="dl-stats">
                <div class="dl-stat">
                    <div class="val" style="color:#1890ff;">2</div>
                    <div class="lbl">ç”Ÿæˆä¸­</div>
                </div>
                <div class="dl-stat">
                    <div class="val" style="color:#52c41a;">18</div>
                    <div class="lbl">å¯ä¸‹è½½</div>
                </div>
                <div class="dl-stat">
                    <div class="val" style="color:#bfbfbf;">5</div>
                    <div class="lbl">å·²è¿‡æœŸ</div>
                </div>
                <div class="dl-stat">
                    <div class="val" style="color:#f5222d;">1</div>
                    <div class="lbl">å¤±è´¥</div>
                </div>
            </div>

            <!-- æ ‡ç­¾ç­›é€‰ -->
            <div class="dl-tabs">
                <button class="dl-tab active" onclick="filterTab('all',this)">å…¨éƒ¨ (26)</button>
                <button class="dl-tab" onclick="filterTab('running',this)">ç”Ÿæˆä¸­ (2)</button>
                <button class="dl-tab" onclick="filterTab('done',this)">å¯ä¸‹è½½ (18)</button>
                <button class="dl-tab" onclick="filterTab('expired',this)">å·²è¿‡æœŸ (5)</button>
                <button class="dl-tab" onclick="filterTab('failed',this)">å¤±è´¥ (1)</button>
            </div>

            <!-- ä¸‹è½½åˆ—è¡¨ -->
            <div id="dlList"></div>
        </main>
    </div>

    <script>
        const dlData = [
            { id: 1, name: 'å®¢æˆ·æ± æ•°æ®å¯¼å‡º - å…¨éƒ¨çŠ¶æ€', type: 'excel', source: 'å®¢æˆ·æ± ç®¡ç†', rows: 324186, size: '45.2 MB', status: 'running', progress: 60, time: '2026-02-11 12:30', user: 'ç®¡ç†å‘˜' },
            { id: 2, name: 'åˆ†å‘è®°å½•å¯¼å‡º - 2026å¹´2æœˆ', type: 'csv', source: 'åˆ†å‘ç®¡ç†', rows: 12580, size: null, status: 'running', progress: 30, time: '2026-02-11 12:28', user: 'ç®¡ç†å‘˜' },
            { id: 3, name: 'å®¢æˆ·æ± æ•°æ®å¯¼å‡º - å†·å´ä¸­å®¢æˆ·', type: 'excel', source: 'å®¢æˆ·æ± ç®¡ç†', rows: 31056, size: '8.7 MB', status: 'done', progress: 100, time: '2026-02-11 11:45', user: 'ç®¡ç†å‘˜', expires: '2026-02-14 11:45' },
            { id: 4, name: 'å¯¹è´¦æ˜ç»† - æ±Ÿè‹é“¶è¡Œ - 2026å¹´1æœˆ', type: 'excel', source: 'å¯¹è´¦ç®¡ç†', rows: 856, size: '1.2 MB', status: 'done', progress: 100, time: '2026-02-10 16:20', user: 'ç®¡ç†å‘˜', expires: '2026-02-13 16:20' },
            { id: 5, name: 'æ”¶è´¹ç»“ç®—è´¦å• - 2026å¹´1æœˆ', type: 'pdf', source: 'æ”¶è´¹ç»“ç®—', rows: null, size: '2.1 MB', status: 'done', progress: 100, time: '2026-02-10 14:00', user: 'ç®¡ç†å‘˜', expires: '2026-02-13 14:00' },
            { id: 6, name: 'åˆ†å‘è®°å½•å¯¼å‡º - 2026å¹´1æœˆ', type: 'csv', source: 'åˆ†å‘ç®¡ç†', rows: 45230, size: '12.3 MB', status: 'done', progress: 100, time: '2026-02-08 09:30', user: 'ç®¡ç†å‘˜', expires: '2026-02-11 09:30' },
            { id: 7, name: 'å®¢æˆ·æ± æ•°æ®å¯¼å‡º - è‹å·å¸‚å¯åˆ†é…', type: 'excel', source: 'å®¢æˆ·æ± ç®¡ç†', rows: 52300, size: '14.8 MB', status: 'done', progress: 100, time: '2026-02-07 15:10', user: 'ç®¡ç†å‘˜', expires: '2026-02-10 15:10' },
            { id: 8, name: 'æ•ˆæœåˆ†ææŠ¥è¡¨ - å…¨æœºæ„ - 2026å¹´1æœˆ', type: 'pdf', source: 'æ•ˆæœåˆ†æ', rows: null, size: '3.5 MB', status: 'done', progress: 100, time: '2026-02-06 10:00', user: 'ç®¡ç†å‘˜', expires: '2026-02-09 10:00' },
            { id: 9, name: 'å¯¹è´¦æ˜ç»† - è‹å·å†œå•†è¡Œ - 2025å¹´12æœˆ', type: 'excel', source: 'å¯¹è´¦ç®¡ç†', rows: 420, size: '680 KB', status: 'expired', progress: 100, time: '2026-01-28 14:30', user: 'ç®¡ç†å‘˜' },
            { id: 10, name: 'å®¢æˆ·æ± æ•°æ®å¯¼å‡º - é»‘åå•', type: 'excel', source: 'å®¢æˆ·æ± ç®¡ç†', rows: 5200, size: '1.5 MB', status: 'expired', progress: 100, time: '2026-01-25 11:00', user: 'ç®¡ç†å‘˜' },
            { id: 11, name: 'åˆ†å‘è®°å½•å¯¼å‡º - å…¨é‡', type: 'csv', source: 'åˆ†å‘ç®¡ç†', rows: 890000, size: null, status: 'failed', progress: 45, time: '2026-02-09 16:40', user: 'ç®¡ç†å‘˜', error: 'æ•°æ®é‡è¿‡å¤§ï¼Œå»ºè®®æŒ‰æœˆä»½åˆ†æ‰¹å¯¼å‡º' },
        ];

        const typeIcons = { excel: 'ğŸ“Š', csv: 'ğŸ“„', pdf: 'ğŸ“•' };
        const typeLabels = { excel: 'Excel', csv: 'CSV', pdf: 'PDF' };

        function renderList(data) {
            const el = document.getElementById('dlList');
            if (data.length === 0) {
                el.innerHTML = '<div class="empty-state"><div class="icon">ğŸ“­</div><div>æš‚æ— ä¸‹è½½ä»»åŠ¡</div></div>';
                return;
            }
            el.innerHTML = data.map(d => {
                let statusHtml = '';
                if (d.status === 'done') statusHtml = '<span class="dl-status done">âœ“ å¯ä¸‹è½½</span>';
                else if (d.status === 'running') statusHtml = '<span class="dl-status running">â³ ç”Ÿæˆä¸­</span>';
                else if (d.status === 'failed') statusHtml = '<span class="dl-status failed">âœ— å¤±è´¥</span>';
                else if (d.status === 'expired') statusHtml = '<span class="dl-status expired">â± å·²è¿‡æœŸ</span>';

                let progressCls = d.status === 'done' ? 'done' : d.progress >= 50 ? 'p60' : 'p30';
                let sizeHtml = d.size ? d.size : 'è®¡ç®—ä¸­...';
                let rowsHtml = d.rows ? d.rows.toLocaleString() + ' è¡Œ' : '';

                let actionsHtml = '';
                if (d.status === 'done') {
                    actionsHtml = `<button class="btn btn-primary btn-sm" onclick="downloadFile(${d.id})">ğŸ“¥ ä¸‹è½½</button>
                    <button class="btn btn-text btn-sm" onclick="deleteFile(${d.id})" style="color:#f5222d;">åˆ é™¤</button>`;
                } else if (d.status === 'running') {
                    actionsHtml = `<button class="btn btn-default btn-sm" disabled>ç­‰å¾…å®Œæˆ...</button>`;
                } else if (d.status === 'failed') {
                    actionsHtml = `<button class="btn btn-default btn-sm" onclick="retryTask(${d.id})">ğŸ”„ é‡è¯•</button>`;
                } else {
                    actionsHtml = `<button class="btn btn-text btn-sm" onclick="deleteFile(${d.id})" style="color:#bfbfbf;">æ¸…ç†</button>`;
                }

                return `<div class="dl-item" data-status="${d.status}">
                <div class="dl-icon ${d.type}">${typeIcons[d.type]}</div>
                <div class="dl-info">
                    <div class="dl-name">${d.name}</div>
                    <div class="dl-meta">
                        <span>ğŸ“ ${typeLabels[d.type]}</span>
                        <span>ğŸ“‚ ${d.source}</span>
                        ${rowsHtml ? `<span>ğŸ“‹ ${rowsHtml}</span>` : ''}
                        <span>ğŸ’¾ ${sizeHtml}</span>
                        <span>ğŸ• ${d.time}</span>
                    </div>
                    ${d.error ? `<div style="font-size:12px;color:#f5222d;margin-top:4px;">âŒ ${d.error}</div>` : ''}
                    ${d.expires ? `<div style="font-size:11px;color:#bfbfbf;margin-top:2px;">æ–‡ä»¶ä¿ç•™è‡³ ${d.expires}</div>` : ''}
                </div>
                <div class="dl-actions">
                    <div class="dl-progress"><div class="dl-progress-bar ${progressCls}"></div></div>
                    ${statusHtml}
                    ${actionsHtml}
                </div>
            </div>`;
            }).join('');
        }

        function filterTab(status, btn) {
            document.querySelectorAll('.dl-tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            if (status === 'all') { renderList(dlData); return; }
            renderList(dlData.filter(d => d.status === status));
        }

        function downloadFile(id) { showToast('å¼€å§‹ä¸‹è½½...'); }
        function deleteFile(id) { if (confirm('ç¡®è®¤åˆ é™¤ï¼Ÿ')) showToast('å·²åˆ é™¤'); }
        function retryTask(id) { showToast('å·²é‡æ–°æäº¤å¯¼å‡ºä»»åŠ¡'); }
        function clearExpired() { if (confirm('ç¡®è®¤æ¸…ç†æ‰€æœ‰å·²è¿‡æœŸæ–‡ä»¶ï¼Ÿ')) showToast('å·²æ¸…ç† 5 ä¸ªè¿‡æœŸæ–‡ä»¶'); }

        function showToast(msg) {
            const t = document.createElement('div');
            t.style.cssText = 'position:fixed;top:20px;right:20px;background:#52c41a;color:#fff;padding:12px 24px;border-radius:8px;z-index:9999;font-size:14px;box-shadow:0 4px 12px rgba(0,0,0,0.15);';
            t.textContent = 'âœ“ ' + msg;
            document.body.appendChild(t);
            setTimeout(() => t.remove(), 2500);
        }

        document.addEventListener('DOMContentLoaded', () => renderList(dlData));
    </script>
</body>

</html>